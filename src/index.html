<!DOCTYPE html>
<html lang="en" ng-app="involved">
<head>
  <title>Involved</title>
  <meta http-equiv="Content-Security-Policy" content="default-src *; script-src 'self'; style-src 'self' 'unsafe-inline';">
  <link rel="stylesheet" href="static/components/octicons/octicons/octicons.css">
  <link rel="stylesheet" href="static/components/primer-css/css/primer.css">
  <link rel="stylesheet" href="static/components/primer-markdown/dist/user-content.css">
  <link rel="stylesheet" href="static/css/style.css">
</head>
<body class="flex-container flex-container-row" ng-controller="TimelineCtrl"  tabindex="-1">
<nav class="menus">
  <div class="profile">
    <img ng-src="{{me.avatar_url}}v=3&s=45" class="avatar avatar-small me">
    <span>{{me.login}}</span>
  </div>
</nav>
<section class="main-contents flex-container">
  <div class="timeline" when-scrolled="loadMore()">
    <div class="timeline-cell flex-container flex-container-row" ng-repeat="t in timeline" ng-click="showEvent(t)">
      <div class="cell-type">
        <span class="octicon" ng-if="t.type !== IssuesEvent" ng-class="{
            CreateEvent: 'octicon-git-branch',
            IssueCommentEvent: 'octicon-comment-discussion', PushEvent: 'octicon-git-commit',
            PullRequestEvent: 'octicon-git-pull-request', CommitCommentEvent: 'octicon-comment-discussion',
            PullRequestReviewCommentEvent: 'octicon-comment-discussion', ReleaseEvent: 'octicon-tag',
            DeleteEvent: 'octicon-trashcan', GollumEvent: 'octicon-book'
          }[t.type]"></span>
        <span ng-if="t.type === 'IssuesEvent'" class="octicon" ng-class="{
            opened: 'octicon-issue-opened',
            closed: 'octicon-issue-closed',
            reopened: 'octicon-issue-reopened'
          }[t.payload.action]"></span>
      </div>
      <div class="cell-body">
        <time>{{t.created_at | fromNow}}</time>
        <div class="repo">{{t.repo.name}}</div>
        <img ng-src="{{t.actor.avatar_url}}v=3&s=40" class="avatar avatar-small">
        <a href="{{t.actor.url}}" class="username">{{t.actor.login}}</a>
        <ng-switch on="t.type">
          <span ng-switch-when="CreateEvent">
            created {{t.payload.ref_type}}
            <div class="title">"{{t.payload.ref}}"</div>
          </span>
          <span ng-switch-when="IssuesEvent">
            {{t.payload.action}} issue #{{t.payload.issue.number}}
            <div class="title">"{{t.payload.issue.title}}"</div>
          </span>
          <span ng-switch-when="IssueCommentEvent">
            commented on issue #{{t.payload.issue.number}}
            <div class="title">"{{t.payload.issue.title}}"</div>
          </span>
          <span ng-switch-when="PushEvent">
            pushed {{t.payload.size}}
            <span ng-if="t.payload.size > 1">commits</span>
            <span ng-if="t.payload.size === 1">commit</span>
            to {{t.payload.ref | removeRef}}
          </span>
          <span ng-switch-when="PullRequestEvent">
            <span ng-if="t.payload.pull_request.merged">merged</span>
            <span ng-if="!t.payload.pull_request.merged">{{t.payload.action}}</span>
            pull request #{{t.payload.pull_request.number}}
            <div class="title">"{{t.payload.pull_request.title}}"</div>
          </span>
          <span ng-switch-when="CommitCommentEvent">
            commented on commit
            @{{t.payload.comment.commit_id | shortSha}}
          </span>
          <span ng-switch-when="PullRequestReviewCommentEvent">
            commented on pull request
            #{{t.payload.pull_request.number}}
            <div class="title">"{{t.payload.pull_request.title}}"</div>
          </span>
          <span ng-switch-when="ReleaseEvent">
            {{t.payload.action}} {{t.payload.release.tag_name}}
            <div class="title" ng-if="t.payload.release.name">"{{t.payload.release.name}}"</div>
          </span>
          <span ng-switch-when="DeleteEvent">
            deleted {{t.payload.ref_type}} {{t.payload.ref}}
          </span>
          <span ng-switch-when="GollumEvent">
            <span ng-repeat="page in t.payload.pages">{{page.action}} "{{page.title}}"</span>
          </span>
          <span ng-switch-default>
            {{t.type}} - {{t.payload.action}}
          </span>
        </ng-switch>
      </div>
    </div>
    <div class="timeline-cell infinite-loading" ng-show="timeline">
      loading...
    </div>
  </div>
  <div class="detail" ng-if="detail">
    <div class="d-head">
      <h2 class="d-repo"><span class="mega-octicon octicon-repo"></span>{{detail.repo.name}}</h2>
      <h1>{{detail.payload.issue.title}}</h1>
      <div>
        <span class="state" ng-class="state(detail.payload.issue.state)">{{detail.payload.issue.state}}</span>
        <span class="author">{{detail.payload.issue.user.login}}</span>
        <span class="meta">
          opened this issue {{detail.payload.issue.created_at | fromNow}} - {{detail.payload.issue.comments}} comments
        </span>
      </div>
    </div>
    <div class="d-body">
      <div class="comment">
        <img ng-src="{{detail.payload.issue.user.avatar_url}}v=3&s=45" class="avatar avatar-small">
        <div class="comment-head">
          <span class="author">{{detail.payload.issue.user.login}}</span>
          <span class="meta"> commented {{detail.payload.issue.created_at | fromNow}}</span>
        </div>
        <div class="comment-body markdown-body" ng-bind-html="detail.payload.issue.body | md"></div>
      </div>

      <span class="hidden-text-expander expander"><a href="#">&hellip;</a></span>

      <div class="comment">
        <img ng-src="{{detail.payload.comment.user.avatar_url}}v=3&s=45" class="avatar avatar-small">
        <div class="comment-head">
          <span class="author">{{detail.payload.comment.user.login}}</span>
          <span class="meta"> commented {{detail.payload.comment.created_at | fromNow}}</span>
        </div>
        <div class="comment-body markdown-body" ng-bind-html="detail.payload.comment.body | md"></div>
      </div>
    </div>
  </div>
</section>

<script src="renderer/init.js"></script>
<script src="static/components/angular/angular.js"></script>
<script src="static/components/angular-resource/angular-resource.js"></script>
<script src="static/components/moment/moment.js"></script>
<script src="static/components/markdown-it/dist/markdown-it.js"></script>
<script src="renderer/app.js"></script>
</body>
</html>
